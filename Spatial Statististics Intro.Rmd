---
title: "Spatial statistics intro"
output: html_notebook
---

### Simple spatial principles

Task: Generate 200 points uniformly in a rectangle.

`runif(n, a, b)` will generate n random numbers anywhere between a and b

```{r}
n <- 200

xmin <- 0
xmax <- 1
ymin <- 0
ymax <- 2

# Sample from a uniform distribution
x <- runif(n, xmin, xmax)
y <- runif(n, ymin, ymax)
```

```{r}
mapxy <- function(a = NA){
  plot(x, y, asp=a)
  rect(xmin, ymin, xmax, ymax)
}

mapxy(0)
```

### Uniform density point pattern in a circle

We might first try selecting a radius and angle uniformly. But that might produce a cluster at small distances.

Instead, we sample the radius from a non-uniform distribution that scales linearly with distance, so we have fewer points at small radii and more at large radii.

`disc()` function creates a circular window for this task.

**Algorithm**

1.  create `n_points` random numbers uniformly from zero to the radius-squared
2.  Calculate the x y coordinates
    1.  x-values are the values of square root of r_squared times the cosine of angle

    2.  y- values are the square root of r_squared times the sine of angle
3.  plot a disc of `radius` then add the points to the plot

```{r}
library(spatstat)
n_points <- 300
radius <- 10

r_squared <- runif(n_points, 0, radius**2)
angle <- runif(n_points, 0, 2*pi)

x <- sqrt(r_squared) * cos(angle)
y <- sqrt(r_squared) * sin(angle)

plot(disc(radius)); points(x,y)
```
